        // 페이지 로드 시 인증 체크
        window.onload = async function() {
            try {
                // 토큰 유효성 검증
                const response = await fetch('/api/member/verify-auth', {
                    credentials: 'include'  // 쿠키를 포함하여 요청
                });

                if (!response.ok) {
                    throw new Error('Token validation failed');
                }

                // 대시보드 데이터 로드
                await loadDashboardData();
            } catch (error) {
                console.error('Token validation error:', error);
                await Swal.fire({
                    icon: 'error',
                    title: '세션 만료',
                    text: '로그인이 만료되었습니다. 다시 로그인해주세요.',
                    confirmButtonText: '확인'
                });
                window.location.href = '/';
                return;
            }
        };

        // 로그아웃 처리
        async function handleLogout() {
            try {
                const response = await fetch('/api/v1/users/logout', {
                    method: 'POST',
                    credentials: 'include'  // 쿠키를 포함하여 요청
                });

                if (response.ok) {
                    window.location.href = '/';
                } else {
                    throw new Error('Logout failed');
                }
            } catch (error) {
                console.error('Logout error:', error);
                await Swal.fire({
                    icon: 'error',
                    title: '로그아웃 실패',
                    text: '로그아웃 처리 중 오류가 발생했습니다.',
                    confirmButtonText: '확인'
                });
            }
        }

        // 대시보드 데이터 로드
        async function loadDashboardData() {
            try {
                const response = await fetch('/api/v1/dashboard/stats', {
                    credentials: 'include'  // 쿠키를 포함하여 요청
                });

                if (response.ok) {
                    const data = await response.json();
                    updateDashboard(data);
                } else {
                    if (response.status === 401) {
                        await Swal.fire({
                            icon: 'error',
                            title: '세션 만료',
                            text: '로그인이 만료되었습니다. 다시 로그인해주세요.',
                            confirmButtonText: '확인'
                        });
                        window.location.href = '/';
                        return;
                    }
                    throw new Error('Failed to load dashboard data');
                }
            } catch (error) {
                console.error('Dashboard data error:', error);
                await Swal.fire({
                    icon: 'error',
                    title: '데이터 로드 실패',
                    text: '대시보드 데이터를 불러오는 중 오류가 발생했습니다.',
                    confirmButtonText: '확인'
                });
            }
        } 